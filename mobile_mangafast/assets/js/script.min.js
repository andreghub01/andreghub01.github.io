/*
 * Movifox Script JS
 */
jQuery(document).ready(function (e) {
  function a(t, a) {
    var i = e(a).parent();
    t
      ? e(i).addClass("process").addClass("noselect")
      : e(i).removeClass("process").removeClass("noselect");
  }
  e(".tooltip-w").tipsy({ live: !0, gravity: "w", opacity: 0.95 }),
    e(".tooltip").tipsy({ live: !0, gravity: "n", opacity: 0.95 }),
    e(".tooltip-s").tipsy({ live: !0, gravity: "s", opacity: 0.95 }),
    e(".tooltip-sw").tipsy({ live: !0, gravity: "sw", opacity: 0.95 }),
    e(".existing_item").tipsy({
      className: "kepsy",
      kepsy: !0,
      fade: !1,
      html: !0,
      live: !0,
      opacity: 0.95,
      gravity: e.fn.tipsy.autoWE,
      title: function () {
        return e(this).find(".existing-details").html();
      },
    });
  var i = !1;
  e(".loadnavi").click(function () {
    var t = e(this),
      s = parseInt(t.attr("data-paged")) + 1,
      o = parseInt(t.attr("data-max")),
      n = t.attr("href"),
      r = t.attr("data-selector"),
      l = "." + r,
      c = "keremiya-loadnavi-" + r + "-page-" + s;
    if (!i)
      if (((i = !0), s <= o)) {
        var d = s;
        a(!0, e(".loader", t)),
          e("." + c).load(n + " " + l, function () {
            e(".current", t).text(s),
              t.attr("data-paged", s),
              s++,
              (n = n.replace(/\/page\/[0-9]*/, "/page/" + s)),
              t.attr("href", n),
              t.before(
                '<div class="keremiya-loadnavi-' + r + "-page-" + s + '"></div>'
              ),
              a(!1, e(".loader", t)),
              (i = !1),
              d == o && t.hide();
          });
      } else t.hide();
    return !1;
  });
  var s = !1;
  e(".modal-form form").submit(function (t) {
    t.preventDefault();
    var i = e(this),
      o = !1;
    if (v(this) && !s) {
      (s = !0), a(!0, i);
      var n = { action: "keremiya_user_action", form: i.serialize() };
      e.ajax({
        type: "post",
        url: kL10n.ajax_url,
        data: n,
        success: function (t) {
          1 == t
            ? (d(e("#redirect-url", i).val()), (o = !0))
            : (e(".display-message", i).fadeIn(),
              e(".display-message", i).html(t));
        },
        complete: function () {
          o || ((s = !1), a(!1, i), c(".modal-inner"));
        },
      });
    }
  });
  var o = !1;
  e("#update-user").submit(function (t) {
    t.preventDefault();
    var i = e(this);
    if (!o) {
      (o = !0), a(!0, i);
      var s = { action: "keremiya_update_user", form: i.serialize() };
      e.ajax({
        type: "post",
        url: kL10n.ajax_url,
        data: s,
        success: function (t) {
          e(".upd").html(t);
        },
        complete: function () {
          (o = !1), a(!1, i);
        },
      });
    }
  });
  var n = !1;
  function r(t, a, i) {
    var s = ".modal",
      o = ".modal-bg",
      n = ".modal-header",
      r = ".modal-inner",
      d = ".modal-form",
      u = ".modal-message",
      m = ".message-header",
      h = ".message-content",
      p = ".message-footer",
      v = ".message-close";
    e(s).hide(),
      e(n).hide(),
      e(d).hide(),
      e("body").addClass("hidden"),
      e(s).show(),
      e(o + ", " + v).click(function () {
        e(s).hide(), e("body").removeClass("hidden");
      }),
      e(u).show(),
      e(m).html(t),
      e(h).html(a),
      e(p).html(i),
      e(".show-modal").live("click", function () {
        return l(this), !1;
      }),
      c(r);
  }
  function l(t, a, i) {
    var s = {
      popup: i || e(t).attr("data-id"),
      is: a || e(t).attr("data-is"),
      modal: ".modal",
      bg: ".modal-bg",
      inner: ".modal-inner",
      form: ".modal-form",
      message: ".modal-message",
      header: ".modal-header",
    };
    e(s.modal).hide(),
      e(s.message).hide(),
      e("body").addClass("hidden"),
      s.is && (e(s.form).hide(), e(s.is).show()),
      e(s.popup).show(),
      e(s.header).show().html(e(".logo").html()),
      e(s.bg).click(function () {
        s.is ? e(s.is).hide() : e(s.popup).hide(),
          e("body").removeClass("hidden");
      }),
      e(s.header).click(function () {
        return e(s.is).hide(), e("body").removeClass("hidden"), !1;
      }),
      c(s.inner);
  }
  function c(t) {
    var a = e(t).height() / 2;
    e(t).css("margin-top", "-" + a + "px");
  }
  function d(e) {
    e && (window.location.href = e);
  }
  function u(e) {
    e.addClass("icon-spinner1").addClass("animate-spin");
  }
  function m(e) {
    e.removeClass("icon-spinner1").removeClass("animate-spin");
  }
  e(".popup form").submit(function (t) {
    t.preventDefault();
    var i = e(this);
    if (v(this) && !n) {
      (n = !0), a(!0, i);
      var s = { action: "keremiya_report", form: i.serialize() };
      e.ajax({
        type: "post",
        url: kL10n.ajax_url,
        data: s,
        dataType: "json",
        success: function (e) {
          e.error
            ? ((n = !1), r(e.title, e.content, e.footer))
            : i.append('<div class="success">' + e.html + "</div>");
        },
        complete: function () {
          a(!1, i);
        },
      });
    }
  }),
    e(".comment-reply-login").on("click", function () {
      return l(this, "#popup", "#login-form"), !1;
    }),
    e(".show-modal").live("click", function () {
      return l(this), !1;
    }),
    e(".keremiya-share").on("click", function () {
      !(function (e) {
        var t = "",
          a = screen.width / 2 - 240,
          i = screen.height / 2 - 190,
          s = encodeURIComponent(location.href),
          o = encodeURIComponent(document.title),
          n = "toolbar=0,status=0,width=480,height=380,top=" + i + ",left=" + a;
        "fb" == e &&
          (t = "http://www.facebook.com/sharer.php?u=" + s + "&t=" + o);
        "tw" == e && (t = "http://twitter.com/share?url=" + s + "&text=" + o);
        "gp" == e && (t = "https://plus.google.com/share?url=" + s);
        window.open(t, "sharer", n);
      })(e(this).attr("data-type"));
    }),
    e("#note .remove").click(function () {
      e(this).parent().slideUp("fast");
    }),
    e(".arg").on("click", function (t) {
      d(e(".remove", this).data("url"));
    }),
    e(".user-my-account").live("click", function (t) {
      e(this).toggleClass("active"),
        m(e(this).find("span")),
        t.stopPropagation();
    }),
    e(document).click(function () {
      e(".dropdown").removeClass("active");
    }),
    e(".spoiler-text").on("click", function () {
      e(this).hide(), e(this).parent().find(".comment-body").show();
    }),
    e(".action").each(function () {
      var a = {
        d: null,
        f: !1,
        e: !1,
        b: 250,
        c: 100,
        a: 10,
        i: e(".trigger", this).outerHeight(!0) + 10,
        g: e(".trigger", this),
        h: e(".popup", this),
      };
      e([a.g.get(0)]).toggle(
        function () {
          a.h.removeClass("m-hide");
        },
        function () {
          a.h.addClass("m-hide");
        }
      ),
        e([a.g.get(0), a.h.get(0)])
          .mouseover(function () {
            if ((a.d && clearTimeout(a.d), !a.e && !a.f))
              return (
                (t = setTimeout(function () {
                  (t = null),
                    (z = a.h.outerHeight(!0)),
                    (a.e = !0),
                    a.h
                      .css({ display: "block", top: "-" + z + "px" })
                      .animate({ opacity: 1 }, a.b, "swing", function () {
                        (a.e = !1), (a.f = !0), a.g.addClass("on-active");
                      });
                }, a.c)),
                !1
              );
          })
          .mouseout(function () {
            return (
              a.d && clearTimeout(a.d),
              clearTimeout(t),
              (a.d = setTimeout(function () {
                (a.d = null),
                  a.h.animate({ opacity: 0 }, a.b, "swing", function () {
                    (a.f = !1),
                      a.h.removeClass("m-hide m-active"),
                      a.h.css("display", "none");
                  }),
                  a.g.removeClass("on-active");
              }, a.c)),
              !1
            );
          });
    }),
    e("#action-parts").each(function () {
      var t = e(".part.active .part-name", this).text();
      e(".active-part", this).html(t);
    }),
    e("#action-langs").each(function () {
      var t = e("li.active", this).html(),
        a = e(".active-part", this);
      t || (t = ""), a.html(t);
    }),
    e(".lang-popup li").on("click", function () {
      e(".lang-popup li").removeClass("active"),
        e(this).addClass("active"),
        e(".lang-button .active-part").html(e(this).html()),
        e(".source-popup .parts-middle").removeClass("active"),
        e("." + e(this).attr("data-this")).addClass("active");
      var t = e(".source-popup").outerHeight(!0);
      return (
        e(".source-popup")
          .css({ display: "block", top: "-" + t + "px" })
          .animate({ opacity: 1 }, 100),
        !1
      );
    }),
    e(".comment-vote").on("click", function () {
      var t, a, i, s, o;
      u(e(this)),
        (t = e(this).attr("data-id")),
        (a = e(this).attr("data-type")),
        (i = e(this)),
        (s = (function (e) {
          for (
            var t = e + "=", a = document.cookie.split(";"), i = 0;
            i < a.length;
            i++
          ) {
            for (var s = a[i]; " " == s.charAt(0); ) s = s.substring(1);
            if (0 == s.indexOf(t)) return s.substring(t.length, s.length);
          }
          return "";
        })("cvote_" + t)),
        (o = { action: "keremiya_comment_vote", id: t, w: a, c: s }),
        e.post(kL10n.ajax_url, o, function (a) {
          if (1 == a) {
            var s = e(".count", i),
              o = e(s).text();
            o++,
              e(s).text(o),
              e(i).addClass("active"),
              (function (e, t, a) {
                var i = new Date();
                i.setTime(i.getTime() + 24 * a * 60 * 60 * 1e3);
                var s = "expires=" + i.toUTCString();
                document.cookie = e + "=" + t + "; " + s;
              })("cvote_" + t, t, 360);
          } else {
            var n = a.split("|");
            r(n[0], n[1], n[2]);
          }
          m(e(i));
        });
    }),
    e("#commentform").submit(function (t) {
      e(this);
      v(this) ? t.stopPropagation() : t.preventDefault();
    });
  var h = !1;
  function p(e) {
    return /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(
      e
    );
  }
  function v(e) {
    var t = "",
      a = e.keremiya_action.value;
    return (
      "register" == a &&
        ("" == e.register_username.value
          ? (t = e.register_username)
          : p(e.register_email.value)
          ? e.register_email.value != e.register_re_email.value
            ? (t = e.register_re_email)
            : "" == e.register_password.value && (t = e.register_password)
          : (t = e.register_email)),
      "login" == a &&
        ("" == e.login_username.value
          ? (t = e.login_username)
          : "" == e.login_password.value && (t = e.login_password)),
      "report" == a &&
        (p(e.report_email.value)
          ? "" == e.report_excerpt.value && (t = e.report_excerpt)
          : (t = e.report_email)),
      "comment" == a &&
        ("" == e.comment.value
          ? (t = e.comment)
          : "" == e.author.value
          ? (t = e.author)
          : p(e.email.value) || (t = e.email)),
      !t || (t.focus(), !1)
    );
  }
  e(".addto").live("click", function () {
    if (!h) {
      h = !0;
      var t = e(this),
        a = t.data("is");
      if (2 == a)
        var i = t
            .parent()
            .parent()
            .parent()
            .parent()
            .parent()
            .attr("data-this"),
          s = t.attr("data-id"),
          o = t;
      else
        (i = t.attr("data-this")),
          (s = t.attr("data-id")),
          (o = t.find("span"));
      u(o),
        jQuery.ajax({
          type: "post",
          url: kL10n.ajax_url,
          data:
            "action=keremiya_addto&this=" +
            i +
            "&nonce=" +
            kL10n.nonce +
            "&post_id=" +
            s,
          dataType: "json",
          success: function (e) {
            e.error
              ? r(e.title, e.content, e.footer)
              : 1 == a
              ? (t.addClass("active"),
                t.removeClass("addto"),
                o.removeClass("icon-plus"),
                o.addClass("icon-ok"))
              : 2 == a
              ? t.parent().parent().parent().parent().hide()
              : t.html(e.html);
          },
          complete: function () {
            (h = !1), m(o);
          },
        });
    }
    return !1;
  }),
    e(".select-type").click(function () {
      var t = e(this).attr("data-open");
      return (
        e(".select-type").removeClass("active"),
        e(".add-content form").hide(),
        e(".add-content #message").hide(),
        e(this).addClass("active"),
        e(t).slideDown(300, function () {
          e("html, body").animate(
            { scrollTop: e(this).offset().top - 80 },
            200
          );
        }),
        !1
      );
    }),
    e(".submit-content").click(function () {
      u(e(this));
    }),
    e(".KR-head button").click(function () {
      var t,
        a,
        i,
        s,
        o,
        n,
        r,
        l = e(this).attr("data-format"),
        c = e(this).parent().attr("data-area");
      (t = l),
        (a = c),
        (i = document.getElementById(a)),
        (s = i.value),
        (o = s.substring(i.selectionStart, i.selectionEnd)),
        (n = s.substring(0, i.selectionStart)),
        (r = s.substring(i.selectionEnd, s.length)),
        (i.value = n + "[" + t + "]" + o + "[/" + t + "]" + r),
        i.focus();
    }),
    e(".KR-textarea textarea").keyup(function () {
      var t = (function (e) {
          var t = 1;
          (e = e.replace(/[\s]+/gim, " ")).replace(/(\s+)/g, function (e) {
            t++;
          }),
            0 == e && (t = 0);
          return t;
        })(e(this).val()),
        a = e(this).closest(".KR-editor");
      e("#textarea-feedback span", a).html(t);
    }),
    e(".cat_tab").click(function () {
      var t = e(this).attr("data-id"),
        a = e(this).parent(),
        i = e(this).parent().parent();
      return (
        e(".cat_tab", a).removeClass("active"),
        e(".cat_wrap", i).removeClass("active"),
        e(this).addClass("active"),
        e("." + t, i).addClass("active"),
        !1
      );
    }),
    e(".tabs").each(function () {
      e("li.tab", this).click(function () {
        e(".tabs li").removeClass("active"),
          e(this).addClass("active"),
          e(".wrap").hide();
        var t = e(this).attr("data-id");
        return e("#" + t).fadeIn("fast"), !1;
      });
    }),
    e(".footer-sticky .close").on("click", function () {
      return e(".footer-sticky").hide(), !1;
    }),
    e(".archive-icons").click(function () {
      e(this).toggleClass("change"),
        e(".side-filter").toggleClass("show"),
        e(".list_items, .loadnavi").toggleClass("hide");
    });
  var f = e(".mobile-menu-icon"),
    g = e(".menu, .col-user-menu"),
    y = !1;
  f.click(function () {
    g.hasClass("show")
      ? (g.removeClass("show"), f.removeClass("show"), (y = !1))
      : (g.addClass("show"), f.addClass("show"), (y = !0));
  });
  var C = e(".mobile-search-icon"),
    w = e(".col-search"),
    k = e("#s"),
    b = !1;
  C.click(function () {
    w.hasClass("show")
      ? (w.removeClass("show"), C.removeClass("show"), (b = !1))
      : (w.addClass("show"), C.addClass("show"), k.focus(), (b = !0));
  }),
    e(document).on("click", function (e) {
      y &&
        (f.is(e.target) ||
          0 !== f.has(e.target).length ||
          g.is(e.target) ||
          0 !== g.has(e.target).length ||
          (g.removeClass("show"), f.removeClass("show"), (y = !1))),
        b &&
          (C.is(e.target) ||
            0 !== C.has(e.target).length ||
            w.is(e.target) ||
            0 !== w.has(e.target).length ||
            (w.removeClass("show"), C.removeClass("show"), (b = !1)));
    });
  var _ = e(".video-sources"),
    x = e(".video-sources-toggle"),
    T = !1;
  _.click(function () {
    x.hasClass("show")
      ? (x.removeClass("show"), (T = !1))
      : (x.addClass("show"), (T = !0));
  }),
    e(document).on("click", function (e) {
      T &&
        (_.is(e.target) ||
          0 !== _.has(e.target).length ||
          x.is(e.target) ||
          0 !== x.has(e.target).length ||
          (x.removeClass("show"), (T = !1)));
    }),
    e(".mix-movies-con .slider").length > 0 &&
      e(".mix-movies-con .slider").owlCarousel({
        rewind: !0,
        autoplay: !0,
        margin: 20,
        nav: !0,
        navText: [
          '<span class="icon-left-open">',
          '<span class="icon-right-open">',
        ],
        dots: !1,
        lazyLoad: !0,
        autoplayTimeout: 2400,
        autoplayHoverPause: !0,
        responsive: {
          0: { items: 2 },
          480: { items: 3 },
          768: { items: 4 },
          992: { items: 4 },
          1200: { items: 6 },
        },
      }),
    e(".related-movies .mix-movies-con .slider").length > 0 &&
      e(".related-movies .mix-movies-con .slider").owlCarousel({
        rewind: !0,
        autoplay: !0,
        margin: 30,
        nav: !0,
        navText: ['<i class="icon-left-open">', '<i class="icon-right-open">'],
        dots: !1,
        lazyLoad: !0,
        autoplayTimeout: 2400,
        autoplayHoverPause: !0,
        responsive: {
          0: { items: 2 },
          480: { items: 3 },
          768: { items: 4 },
          992: { items: 5 },
          1200: { items: 6 },
        },
      }),
    e(".movie-box .poster").tilt({
      glare: !0,
      maxGlare: 0.3,
      maxTilt: 25,
      speed: 200,
    }),
    e(".episode-box .poster").tilt({
      glare: !0,
      maxGlare: 0.3,
      maxTilt: 25,
      speed: 200,
    });
});
