/*
 * Movifox Live Search JS
 */
jQuery(document).ready(function (e) {
  var s,
    a =
      ((s = 0),
      function (e, a) {
        clearTimeout(s), (s = setTimeout(e, a));
      }),
    n = !1,
    t = !0;
  e("#s").on("input", function () {
    var s = this.value;
    a(function () {
      if (s.length <= 2)
        return (
          e(sL10n.area).hide(),
          void e(sL10n.button)
            .find("span")
            .removeClass("icon-spinner1")
            .removeClass("animate-spin")
        );
      n ||
        ((n = !0),
        e(sL10n.button)
          .find("span")
          .addClass("icon-spinner1")
          .addClass("animate-spin"),
        e(sL10n.area).find("ul").addClass("process").addClass("noselect"),
        e.ajax({
          type: "GET",
          url: sL10n.api,
          data: "keyword=" + s + "&nonce=" + sL10n.nonce,
          dataType: "json",
          success: function (a) {
            if (a.error) e(sL10n.area).hide();
            else {
              e(sL10n.area).show();
              var n = '<span class="icon-search-1">' + s + "</span>",
                t =
                  '<a class="more" href="javascript:;" onclick="document.getElementById(\'search-form\').submit();">' +
                  sL10n.more.replace("%s", n) +
                  "</a>",
                i = [];
              e.each(a, function (e, s) {
                (name = ""),
                  (date = ""),
                  (imdb = ""),
                  !1 !== s.extra.date &&
                    (date =
                      "<span class='release'>(" + s.extra.date + ")</span>"),
                  !1 !== s.extra.names &&
                    (name = "<span class='otm'>" + s.extra.names + "</span>"),
                  !1 !== s.extra.imdb &&
                    (imdb =
                      "<div class='imdb'><span class='icon-star'>IMDB: " +
                      s.extra.imdb +
                      "</span></div>"),
                  i.push(
                    "<li id='" +
                      e +
                      "'><a href='" +
                      s.url +
                      "' class='clearfix'><div class='poster'><img src='" +
                      s.img +
                      "' /></div><div class='title'>" +
                      s.title +
                      "</div><div class='other-name'>" +
                      name +
                      date +
                      "</div>" +
                      imdb +
                      "</a></li>"
                  );
              }),
                e(sL10n.area).html("<ul>" + i.join("") + t + "</ul>");
            }
          },
          complete: function () {
            (n = !1),
              (t = !1),
              e(sL10n.button)
                .find("span")
                .removeClass("icon-spinner1")
                .removeClass("animate-spin"),
              e(sL10n.area)
                .find("ul")
                .removeClass("process")
                .removeClass("noselect");
          },
        }));
    }, 500);
  }),
    e(document).on("keypress", "#search-form", function (e) {
      if (t) return 13 != e.keyCode;
    }),
    e(document).click(function () {
      e(event.target);
      0 == e(event.target).closest("#s").length
        ? e(sL10n.area).hide()
        : e(sL10n.area).show();
    });
});
